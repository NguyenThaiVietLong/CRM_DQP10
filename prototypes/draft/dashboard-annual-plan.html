<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard K·∫ø ho·∫°ch NƒÉm - D√¢n Qu√¢n T·ª± V·ªá</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <style>
      .material-symbols-outlined {
        font-variation-settings:
          "FILL" 0,
          "wght" 400,
          "GRAD" 0,
          "opsz" 24;
      }
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              olive: {
                DEFAULT: "#697565",
                50: "#f6f7f6",
                100: "#e3e6e2",
                200: "#c7cdc5",
                300: "#a5ada0",
                400: "#858e7f",
                500: "#697565",
                600: "#535d50",
                700: "#434a42",
                800: "#373c36",
                900: "#2f332e",
              },
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-gray-50" x-data="dashboardAnnualPlan()">
    <div class="flex h-screen overflow-hidden">
      <!-- Sidebar -->
      <aside
        class="w-64 flex-shrink-0 bg-white border-r border-gray-200 flex flex-col p-4 hidden md:flex h-full"
      >
        <div class="flex gap-3 px-2 py-2 mb-4">
          <div
            class="bg-olive/20 rounded-full size-10 flex items-center justify-center"
          >
            <span class="material-symbols-outlined text-olive">shield</span>
          </div>
          <div class="flex flex-col justify-center">
            <h1 class="text-gray-900 text-base font-bold">D√¢n Qu√¢n T·ª± V·ªá</h1>
            <p class="text-gray-500 text-xs">H·ªá th·ªëng qu·∫£n l√Ω</p>
          </div>
        </div>

        <!-- User Profile -->
        <div
          class="mb-4 p-3 bg-gradient-to-r from-olive/10 to-olive/5 rounded-lg border border-olive/20"
        >
          <div class="flex items-center gap-2">
            <div class="relative">
              <div
                class="size-10 rounded-full bg-olive/20 flex items-center justify-center"
              >
                <span class="material-symbols-outlined text-olive text-2xl"
                  >account_circle</span
                >
              </div>
              <span
                class="absolute bottom-0 right-0 size-3 bg-green-500 border-2 border-white rounded-full"
              ></span>
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-bold text-gray-900 truncate">
                Administrator
              </p>
              <p class="text-xs text-gray-600">
                <span
                  class="px-2 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-700"
                >
                  Admin
                </span>
              </p>
            </div>
          </div>
        </div>

        <nav class="flex flex-col gap-2">
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="index.html"
          >
            <span class="material-symbols-outlined text-gray-600">home</span>
            <p class="text-sm font-medium text-gray-600">Trang ch·ªß</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg bg-olive/10 text-olive"
            href="dashboard-tong-hop.html"
          >
            <span
              class="material-symbols-outlined"
              style="font-variation-settings: &quot;FILL&quot; 1"
              >assessment</span
            >
            <p class="text-sm font-bold">Dashboard</p>
          </a>
          <div>
            <div class="flex items-center gap-3 px-3 py-2 text-gray-700">
              <span class="material-symbols-outlined text-gray-600">event</span>
              <p class="text-sm font-bold text-gray-700">Ho·∫°t ƒë·ªông</p>
            </div>
            <div class="ml-6 space-y-1 border-l-2 border-gray-200 pl-3">
              <a
                class="flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-gray-50 text-gray-600"
                href="activity-list.html"
              >
                <span class="size-1.5 rounded-full bg-gray-400"></span>
                <p class="text-sm font-medium">Danh s√°ch</p>
              </a>
              <a
                class="flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-gray-50 text-gray-600"
                href="activity-calendar.html"
              >
                <span class="size-1.5 rounded-full bg-gray-400"></span>
                <p class="text-sm font-medium">L·ªãch</p>
              </a>
              <a
                class="flex items-center gap-2 px-3 py-1.5 rounded-lg hover:bg-gray-50 text-gray-600"
                href="module-lich-truc.html"
              >
                <span class="size-1.5 rounded-full bg-gray-400"></span>
                <p class="text-sm font-medium">L·ªãch tr·ª±c</p>
              </a>
            </div>
          </div>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module2-personnel-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">group</span>
            <p class="text-sm font-medium text-gray-600">Nh√¢n s·ª±</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module3-inventory-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600"
              >inventory_2</span
            >
            <p class="text-sm font-medium text-gray-600">Kho</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module4-documents-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">folder</span>
            <p class="text-sm font-medium text-gray-600">T√†i li·ªáu</p>
          </a>
        </nav>

        <div class="mt-auto pt-4 border-t border-gray-200 space-y-2">
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-bold bg-olive text-white hover:bg-olive/90 transition-colors justify-center"
            href="#"
          >
            <span class="material-symbols-outlined text-xl">logout</span>
            <span>ƒêƒÉng xu·∫•t</span>
          </a>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 flex flex-col overflow-hidden">
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4">
          <div class="flex items-center justify-between mb-3">
            <div>
              <h1 class="text-2xl font-bold text-gray-900">
                Dashboard K·∫ø ho·∫°ch NƒÉm
              </h1>
              <p class="text-sm text-gray-500 mt-1">
                Theo d√µi ti·∫øn ƒë·ªô th·ª±c hi·ªán KPI theo k·∫ø ho·∫°ch c·ªßa Th√†nh ƒëo√†n
              </p>
            </div>
            <div class="flex items-center gap-3">
              <select
                x-model="selectedMonth"
                class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-olive"
              >
                <option value="all">C·∫£ nƒÉm 2026</option>
                <option value="1">Th√°ng 1/2026</option>
                <option value="2">Th√°ng 2/2026</option>
                <option value="3">Th√°ng 3/2026</option>
                <option value="4">Th√°ng 4/2026</option>
                <option value="5">Th√°ng 5/2026</option>
                <option value="6">Th√°ng 6/2026</option>
                <option value="7">Th√°ng 7/2026</option>
                <option value="8">Th√°ng 8/2026</option>
                <option value="9">Th√°ng 9/2026</option>
                <option value="10">Th√°ng 10/2026</option>
                <option value="11">Th√°ng 11/2026</option>
                <option value="12">Th√°ng 12/2026</option>
              </select>
            </div>
          </div>

          <!-- View Switcher -->
          <div class="flex items-center gap-2 bg-gray-100 p-1 rounded-lg w-fit">
            <button
              @click="viewMode = 'table'"
              :class="viewMode === 'table' ? 'bg-white shadow' : ''"
              class="px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2"
            >
              <span class="material-symbols-outlined text-lg">table_chart</span>
              <span>B·∫£ng</span>
            </button>
            <button
              @click="viewMode = 'bar'"
              :class="viewMode === 'bar' ? 'bg-white shadow' : ''"
              class="px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2"
            >
              <span class="material-symbols-outlined text-lg">bar_chart</span>
              <span>Bi·ªÉu ƒë·ªì</span>
            </button>
            <button
              @click="viewMode = 'cards'"
              :class="viewMode === 'cards' ? 'bg-white shadow' : ''"
              class="px-4 py-2 rounded-md text-sm font-medium transition-all flex items-center gap-2"
            >
              <span class="material-symbols-outlined text-lg">grid_view</span>
              <span>Th·∫ª</span>
            </button>
          </div>
        </header>

        <!-- Content -->
        <div class="flex-1 overflow-auto p-6">
          <!-- Summary Stats -->
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-lg border border-gray-200 p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-500">T·ªïng KPI</p>
                  <p
                    class="text-2xl font-bold text-gray-900 mt-1"
                    x-text="totalTarget"
                  ></p>
                </div>
                <div
                  class="size-12 bg-blue-100 rounded-lg flex items-center justify-center"
                >
                  <span class="material-symbols-outlined text-blue-600"
                    >target</span
                  >
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-500">ƒê√£ ho√†n th√†nh</p>
                  <p
                    class="text-2xl font-bold text-green-600 mt-1"
                    x-text="totalCompleted"
                  ></p>
                </div>
                <div
                  class="size-12 bg-green-100 rounded-lg flex items-center justify-center"
                >
                  <span class="material-symbols-outlined text-green-600"
                    >check_circle</span
                  >
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-500">C√≤n l·∫°i</p>
                  <p
                    class="text-2xl font-bold mt-1"
                    :class="remaining > 0 ? 'text-orange-600' : 'text-gray-900'"
                    x-text="Math.max(remaining, 0)"
                  ></p>
                </div>
                <div
                  class="size-12 bg-orange-100 rounded-lg flex items-center justify-center"
                >
                  <span class="material-symbols-outlined text-orange-600"
                    >pending</span
                  >
                </div>
              </div>
            </div>
            <div class="bg-white rounded-lg border border-gray-200 p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-500">Ti·∫øn ƒë·ªô</p>
                  <p
                    class="text-2xl font-bold mt-1"
                    :class="progress >= 100 ? 'text-green-600' : 'text-gray-900'"
                    x-text="progress + '%'"
                  ></p>
                </div>
                <div
                  class="size-12 rounded-lg flex items-center justify-center"
                  :class="progress >= 100 ? 'bg-green-100' : 'bg-purple-100'"
                >
                  <span
                    class="material-symbols-outlined"
                    :class="progress >= 100 ? 'text-green-600' : 'text-purple-600'"
                    >percent</span
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- Table View -->
          <div
            x-show="viewMode === 'table'"
            class="bg-white rounded-lg border border-gray-200 overflow-hidden"
          >
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      Nh√≥m c√¥ng vi·ªác
                    </th>
                    <th
                      class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      M·ª•c ti√™u
                    </th>
                    <th
                      class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      Ho√†n th√†nh
                    </th>
                    <th
                      class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      C√≤n l·∫°i
                    </th>
                    <th
                      class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"
                    >
                      Ti·∫øn ƒë·ªô
                    </th>
                    <th
                      class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase"
                    >
                      Tr·∫°ng th√°i
                    </th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <template x-for="group in workGroups" :key="group.id">
                    <tr class="hover:bg-gray-50">
                      <td class="px-6 py-4">
                        <div class="flex items-center gap-3">
                          <div
                            class="size-10 rounded-lg flex items-center justify-center"
                            :style="`background-color: ${group.color}20`"
                          >
                            <span
                              class="material-symbols-outlined"
                              :style="`color: ${group.color}`"
                              x-text="group.icon"
                            ></span>
                          </div>
                          <div>
                            <p
                              class="font-medium text-gray-900"
                              x-text="group.name"
                            ></p>
                            <p
                              class="text-xs text-gray-500"
                              x-text="group.code"
                            ></p>
                          </div>
                        </div>
                      </td>
                      <td class="px-6 py-4 text-center">
                        <span
                          class="text-lg font-bold text-gray-900"
                          x-text="group.target"
                        ></span>
                      </td>
                      <td class="px-6 py-4 text-center">
                        <span
                          class="text-lg font-bold text-green-600"
                          x-text="group.completed"
                        ></span>
                      </td>
                      <td class="px-6 py-4 text-center">
                        <span
                          class="text-lg font-semibold"
                          :class="group.remaining > 0 ? 'text-orange-600' : 'text-gray-400'"
                          x-text="Math.max(group.remaining, 0)"
                        ></span>
                      </td>
                      <td class="px-6 py-4">
                        <div class="flex items-center gap-3">
                          <div class="flex-1 bg-gray-200 rounded-full h-3">
                            <div
                              class="h-3 rounded-full transition-all"
                              :class="group.progress >= 100 ? 'bg-green-500' : 'bg-blue-500'"
                              :style="`width: ${Math.min(group.progress, 100)}%`"
                            ></div>
                          </div>
                          <span
                            class="text-sm font-semibold min-w-[50px] text-right"
                            :class="group.progress >= 100 ? 'text-green-600' : 'text-gray-900'"
                            x-text="group.progress + '%'"
                          ></span>
                        </div>
                      </td>
                      <td class="px-6 py-4 text-center">
                        <span
                          class="px-3 py-1 rounded-full text-xs font-medium"
                          :class="group.progress >= 100 ? 'bg-green-100 text-green-700' : group.progress >= 50 ? 'bg-blue-100 text-blue-700' : 'bg-orange-100 text-orange-700'"
                          x-text="group.progress >= 100 ? (group.progress > 100 ? 'V∆∞·ª£t KPI' : 'Ho√†n th√†nh') : group.progress >= 50 ? 'ƒêang th·ª±c hi·ªán' : 'C·∫ßn ƒë·∫©y nhanh'"
                        ></span>
                      </td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Bar Chart View -->
          <div
            x-show="viewMode === 'bar'"
            class="bg-white rounded-lg border border-gray-200 p-6"
          >
            <canvas id="barChart" height="100"></canvas>
          </div>

          <!-- Cards View -->
          <div
            x-show="viewMode === 'cards'"
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
          >
            <template x-for="group in workGroups" :key="group.id">
              <div
                class="bg-white rounded-lg border border-gray-200 p-5 hover:shadow-lg transition-shadow"
              >
                <div class="flex items-start justify-between mb-4">
                  <div class="flex items-center gap-3">
                    <div
                      class="size-12 rounded-lg flex items-center justify-center"
                      :style="`background-color: ${group.color}20`"
                    >
                      <span
                        class="material-symbols-outlined text-2xl"
                        :style="`color: ${group.color}`"
                        x-text="group.icon"
                      ></span>
                    </div>
                    <div>
                      <h3
                        class="font-semibold text-gray-900"
                        x-text="group.name"
                      ></h3>
                      <p class="text-xs text-gray-500" x-text="group.code"></p>
                    </div>
                  </div>
                  <span
                    class="px-2 py-1 rounded-full text-xs font-medium"
                    :class="group.progress >= 100 ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'"
                    x-text="group.progress + '%'"
                  ></span>
                </div>

                <div class="space-y-3 mb-4">
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">M·ª•c ti√™u</span>
                    <span
                      class="text-lg font-bold text-gray-900"
                      x-text="group.target"
                    ></span>
                  </div>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">Ho√†n th√†nh</span>
                    <span
                      class="text-lg font-bold text-green-600"
                      x-text="group.completed"
                    ></span>
                  </div>
                  <div class="flex items-center justify-between">
                    <span class="text-sm text-gray-600">C√≤n l·∫°i</span>
                    <span
                      class="text-lg font-semibold"
                      :class="group.remaining > 0 ? 'text-orange-600' : 'text-gray-400'"
                      x-text="Math.max(group.remaining, 0)"
                    ></span>
                  </div>
                </div>

                <div class="bg-gray-200 rounded-full h-3 overflow-hidden">
                  <div
                    class="h-full transition-all"
                    :class="group.progress >= 100 ? 'bg-green-500' : 'bg-blue-500'"
                    :style="`width: ${Math.min(group.progress, 100)}%`"
                  ></div>
                </div>

                <div
                  class="mt-3 flex items-center justify-between text-xs"
                  :class="group.progress >= 100 ? 'text-green-600' : 'text-gray-500'"
                >
                  <span
                    x-text="group.progress >= 100 ? (group.progress > 100 ? 'üéâ ƒê√£ v∆∞·ª£t KPI!' : '‚úì Ho√†n th√†nh KPI') : 'ƒêang th·ª±c hi·ªán'"
                  ></span>
                  <span
                    class="font-semibold"
                    x-text="group.progress + '%'"
                  ></span>
                </div>
              </div>
            </template>
          </div>
        </div>
      </main>
    </div>

    <script>
      function dashboardAnnualPlan() {
        return {
          selectedMonth: "all",
          viewMode: "table",
          workGroups: [
            {
              id: 1,
              code: "HUANLUYEN",
              name: "C√¥ng t√°c Hu·∫•n luy·ªán",
              target: 20,
              completed: 22,
              icon: "military_tech",
              color: "#3B82F6",
            },
            {
              id: 2,
              code: "DIEUDONGG",
              name: "C√¥ng t√°c ƒêi·ªÅu ƒë·ªông",
              target: 30,
              completed: 18,
              icon: "swap_horiz",
              color: "#10B981",
            },
            {
              id: 3,
              code: "CHINHTR",
              name: "C√¥ng t√°c Ch√≠nh tr·ªã",
              target: 30,
              completed: 28,
              icon: "campaign",
              color: "#F59E0B",
            },
            {
              id: 4,
              code: "KTTC",
              name: "Ki·ªÉm tra t√≠nh chi·∫øn ƒë·∫•u",
              target: 15,
              completed: 10,
              icon: "verified",
              color: "#EF4444",
            },
            {
              id: 5,
              code: "VANNGH·ªÄ",
              name: "VƒÉn ngh·ªá - Th·ªÉ thao",
              target: 12,
              completed: 8,
              icon: "sports",
              color: "#8B5CF6",
            },
          ],
          chart: null,

          init() {
            this.$nextTick(() => {
              this.initChart();
            });

            this.$watch("viewMode", () => {
              if (this.viewMode === "bar") {
                this.$nextTick(() => this.initChart());
              }
            });
          },

          get totalTarget() {
            return this.workGroups.reduce((sum, g) => sum + g.target, 0);
          },

          get totalCompleted() {
            return this.workGroups.reduce((sum, g) => sum + g.completed, 0);
          },

          get remaining() {
            return this.totalTarget - this.totalCompleted;
          },

          get progress() {
            return Math.round((this.totalCompleted / this.totalTarget) * 100);
          },

          initChart() {
            const ctx = document.getElementById("barChart");
            if (!ctx) return;

            if (this.chart) this.chart.destroy();

            const data = this.workGroups.map((g) => ({
              ...g,
              remaining: g.target - g.completed,
              progress: Math.round((g.completed / g.target) * 100),
            }));

            this.chart = new Chart(ctx, {
              type: "bar",
              data: {
                labels: data.map((g) => g.name),
                datasets: [
                  {
                    label: "M·ª•c ti√™u",
                    data: data.map((g) => g.target),
                    backgroundColor: "#94A3B8",
                    borderRadius: 6,
                  },
                  {
                    label: "Ho√†n th√†nh",
                    data: data.map((g) => g.completed),
                    backgroundColor: data.map((g) =>
                      g.completed >= g.target ? "#10B981" : "#3B82F6",
                    ),
                    borderRadius: 6,
                  },
                ],
              },
              options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                  legend: { position: "top" },
                  title: {
                    display: true,
                    text: "Bi·ªÉu ƒë·ªì Th·ª±c hi·ªán KPI NƒÉm 2026",
                    font: { size: 16, weight: "bold" },
                  },
                },
                scales: {
                  y: {
                    beginAtZero: true,
                    title: { display: true, text: "S·ªë l∆∞·ª£ng c√¥ng vi·ªác" },
                  },
                  x: { ticks: { maxRotation: 45, minRotation: 0 } },
                },
              },
            });
          },
        };
      }

      // Enhance workGroups with computed properties
      document.addEventListener("alpine:init", () => {
        Alpine.data("dashboardAnnualPlan", () => {
          const base = dashboardAnnualPlan();
          base.workGroups = base.workGroups.map((g) => ({
            ...g,
            get remaining() {
              return this.target - this.completed;
            },
            get progress() {
              return Math.round((this.completed / this.target) * 100);
            },
          }));
          return base;
        });
      });
    </script>
  </body>
</html>
