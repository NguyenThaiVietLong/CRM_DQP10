<!DOCTYPE html>
<html class="light" lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Module 5: Quản Lý Phân Quyền - CRM Dân Quân Phường 10</title>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Alpine.js -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#556B2F",
              "primary-dark": "#4a5d28",
              olive: "#556B2F",
              "background-light": "#f7f7f6",
              "background-dark": "#1a1d15",
              "text-main": "#0f172a",
              "text-secondary": "#64748b",
              "border-light": "#e2e8f0",
            },
            fontFamily: {
              display: ["Inter", "sans-serif"],
            },
          },
        },
      };
    </script>

    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background-color: #cbd5e1;
        border-radius: 20px;
      }
      [x-cloak] {
        display: none !important;
      }
    </style>
  </head>

  <body
    class="bg-background-light dark:bg-background-dark text-text-main font-display"
    x-data="permissionsApp()"
  >
    <div class="flex h-screen w-full overflow-hidden">
      <!-- Sidebar -->
      <aside
        class="w-64 flex-shrink-0 bg-white border-r border-gray-200 flex flex-col p-4 hidden md:flex h-full"
      >
        <div class="flex gap-3 px-2 py-2 mb-4">
          <div
            class="bg-olive/20 rounded-full size-10 flex items-center justify-center"
          >
            <span class="material-symbols-outlined text-olive">shield</span>
          </div>
          <div class="flex flex-col justify-center">
            <h1 class="text-gray-900 text-base font-bold">Dân Quân Tự Vệ</h1>
            <p class="text-gray-500 text-xs">Hệ thống quản lý</p>
          </div>
        </div>

        <nav class="flex flex-col gap-2">
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module6-dashboard-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">home</span>
            <p class="text-sm font-medium text-gray-600">Tổng quan</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module2-personnel-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">group</span>
            <p class="text-sm font-medium text-gray-600">Nhân sự</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module1-activities-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">event</span>
            <p class="text-sm font-medium text-gray-600">Hoạt động</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module3-inventory-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600"
              >inventory_2</span
            >
            <p class="text-sm font-medium text-gray-600">Thiết bị</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-gray-50 transition-colors"
            href="module4-documents-complete.html"
          >
            <span class="material-symbols-outlined text-gray-600">folder</span>
            <p class="text-sm font-medium text-gray-600">Tài liệu</p>
          </a>
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg bg-olive/10"
            href="module5-permissions-complete.html"
          >
            <span
              class="material-symbols-outlined text-olive"
              style="font-variation-settings: 'FILL' 1"
              >admin_panel_settings</span
            >
            <p class="text-sm font-bold text-olive">Phân quyền</p>
          </a>
        </nav>

        <div class="mt-auto pt-4 border-t border-gray-200 space-y-2">
          <a
            class="flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-bold bg-olive text-white hover:bg-olive/90 transition-colors justify-center"
            href="#"
          >
            <span class="material-symbols-outlined text-xl">logout</span>
            <span>Đăng xuất</span>
          </a>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="flex-1 flex flex-col h-full overflow-hidden">
        <!-- Header -->
        <header
          class="flex items-center justify-between border-b border-border-light bg-white px-8 py-3"
        >
          <h2 class="text-text-main text-lg font-bold">Quản Lý Phân Quyền</h2>
          <div class="flex items-center gap-4">
            <input
              class="hidden md:block w-64 px-4 h-10 rounded-lg border border-border-light placeholder:text-text-secondary"
              placeholder="Tìm kiếm nhóm quyền..."
            />
            <button class="relative p-2">
              <span class="material-symbols-outlined">notifications</span>
              <span
                class="absolute top-2 right-2 size-2 bg-red-500 rounded-full"
              ></span>
            </button>
          </div>
        </header>

        <!-- Content Area -->
        <div class="flex-1 overflow-y-auto p-6">
          <div class="max-w-6xl mx-auto">
            <div class="flex justify-between items-center mb-6">
              <h1 class="text-3xl font-black text-text-main">
                Quản Lý Nhóm Quyền
              </h1>
              <button
                @click="showModal = true"
                class="flex items-center gap-2 bg-primary hover:bg-primary-dark text-white px-5 py-2.5 rounded-lg font-bold text-sm shadow-lg"
              >
                <span class="material-symbols-outlined text-[20px]">add</span>
                Thêm nhóm quyền
              </button>
            </div>

            <!-- Filters -->
            <div class="bg-white rounded-xl p-4 mb-6 flex gap-4">
              <input
                class="flex-1 px-4 h-11 rounded-lg border border-border-light"
                placeholder="Tìm kiếm theo tên nhóm quyền..."
              />
              <button
                class="px-6 py-2.5 border border-border-light rounded-lg hover:bg-gray-50 font-medium"
              >
                <span
                  class="material-symbols-outlined text-[18px] align-middle mr-1"
                  >filter_list</span
                >
                Bộ lọc
              </button>
            </div>

            <!-- Table -->
            <div
              class="bg-white rounded-xl border border-border-light overflow-hidden"
            >
              <table class="w-full">
                <thead class="bg-gray-50 border-b border-border-light">
                  <tr>
                    <th
                      class="px-6 py-4 text-left text-xs font-bold uppercase text-text-secondary"
                    >
                      Tên nhóm quyền
                    </th>
                    <th
                      class="px-6 py-4 text-left text-xs font-bold uppercase text-text-secondary"
                    >
                      Mô tả
                    </th>
                    <th
                      class="px-6 py-4 text-center text-xs font-bold uppercase text-text-secondary"
                    >
                      Số thành viên
                    </th>
                    <th
                      class="px-6 py-4 text-center text-xs font-bold uppercase text-text-secondary"
                    >
                      Hành động
                    </th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-border-light">
                  <template x-for="role in roles" :key="role.id">
                    <tr class="hover:bg-gray-50">
                      <td
                        class="px-6 py-4 text-sm font-semibold text-text-main"
                        x-text="role.name"
                      ></td>
                      <td
                        class="px-6 py-4 text-sm text-text-secondary"
                        x-text="role.description"
                      ></td>
                      <td class="px-6 py-4 text-center">
                        <span
                          class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700"
                          x-text="role.members + ' người'"
                        ></span>
                      </td>
                      <td class="px-6 py-4">
                        <div class="flex justify-center items-center gap-2">
                          <button
                            class="p-2 text-text-secondary hover:text-primary"
                            title="Xem chi tiết"
                          >
                            <span class="material-symbols-outlined text-[20px]"
                              >visibility</span
                            >
                          </button>
                          <button
                            @click="editRole(role)"
                            class="p-2 text-text-secondary hover:text-primary"
                            title="Chỉnh sửa"
                          >
                            <span class="material-symbols-outlined text-[20px]"
                              >edit</span
                            >
                          </button>
                          <button
                            class="p-2 text-text-secondary hover:text-red-500"
                            title="Xóa"
                          >
                            <span class="material-symbols-outlined text-[20px]"
                              >delete</span
                            >
                          </button>
                        </div>
                      </td>
                    </tr>
                  </template>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Edit Permissions Modal -->
    <div
      x-show="showModal"
      x-cloak
      class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"
      @click.self="showModal = false"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col"
        @click.stop
      >
        <!-- Modal Header -->
        <div
          class="flex justify-between items-center p-6 border-b border-border-light"
        >
          <h2
            class="text-xl font-bold text-text-main"
            x-text="selectedRole ? 'Sửa nhóm quyền: ' + selectedRole.name : 'Thêm nhóm quyền mới'"
          ></h2>
          <button
            @click="showModal = false"
            class="text-text-secondary hover:text-text-main"
          >
            <span class="material-symbols-outlined">close</span>
          </button>
        </div>

        <!-- Modal Body -->
        <div class="p-6 space-y-6 overflow-y-auto flex-1">
          <!-- Group Name -->
          <div>
            <label class="block text-sm font-medium text-text-main mb-2"
              >Tên nhóm quyền <span class="text-red-500">*</span></label
            >
            <input
              class="w-full px-4 py-3 rounded-lg border border-border-light focus:ring-2 focus:ring-primary/20 focus:border-primary"
              type="text"
              :value="selectedRole?.name || ''"
              placeholder="Nhập tên nhóm quyền"
            />
          </div>

          <!-- Permissions Matrix -->
          <div class="space-y-4">
            <h3
              class="text-sm font-bold uppercase tracking-wider text-text-main"
            >
              Phân hệ quản lý
            </h3>

            <!-- Header Row -->
            <div
              class="grid grid-cols-12 gap-4 items-center text-sm font-medium text-text-secondary"
            >
              <div class="col-span-3">Tính năng</div>
              <div class="col-span-2 text-center">Chọn tất cả</div>
              <div class="col-span-7 grid grid-cols-5 text-center">
                <span>Tạo</span>
                <span>Xem</span>
                <span>Sửa</span>
                <span>Xóa</span>
                <span>Duyệt</span>
              </div>
            </div>

            <!-- Permission Rows -->
            <template x-for="(perm, index) in permissions" :key="index">
              <div
                class="grid grid-cols-12 gap-4 items-center py-3 text-sm rounded"
                :class="index % 2 === 0 ? 'bg-gray-50' : ''"
              >
                <div
                  class="col-span-3 font-medium text-text-main"
                  x-text="perm.name"
                ></div>
                <div class="col-span-2 flex justify-center">
                  <input
                    class="rounded text-primary focus:ring-primary/50"
                    type="checkbox"
                  />
                </div>
                <div class="col-span-7 grid grid-cols-5 text-center">
                  <div class="flex justify-center">
                    <input
                      class="rounded text-primary focus:ring-primary/50"
                      type="checkbox"
                    />
                  </div>
                  <div class="flex justify-center">
                    <input
                      class="rounded text-primary focus:ring-primary/50"
                      type="checkbox"
                    />
                  </div>
                  <div class="flex justify-center">
                    <input
                      class="rounded text-primary focus:ring-primary/50"
                      type="checkbox"
                    />
                  </div>
                  <div class="flex justify-center">
                    <input
                      class="rounded text-primary focus:ring-primary/50"
                      type="checkbox"
                    />
                  </div>
                  <div class="flex justify-center">
                    <input
                      class="rounded text-primary focus:ring-primary/50"
                      type="checkbox"
                    />
                  </div>
                </div>
              </div>
            </template>
          </div>
        </div>

        <!-- Modal Footer -->
        <div
          class="flex justify-end items-center p-6 border-t border-border-light gap-3"
        >
          <button
            @click="showModal = false"
            class="px-6 py-2.5 text-sm font-medium text-text-secondary bg-gray-100 rounded-lg hover:bg-gray-200"
          >
            Hủy
          </button>
          <button
            class="px-6 py-2.5 text-sm font-bold text-white bg-primary rounded-lg hover:bg-primary-dark shadow-sm"
          >
            Lưu thay đổi
          </button>
        </div>
      </div>
    </div>

    <script>
      function permissionsApp() {
        return {
          showModal: false,
          selectedRole: null,
          roles: [
            {
              id: 1,
              name: "Chỉ huy trưởng",
              description:
                "Toàn quyền quản lý hệ thống, phê duyệt mọi hoạt động",
              members: 2,
            },
            {
              id: 2,
              name: "Cán bộ nhân sự",
              description: "Quản lý thông tin nhân sự, hồ sơ dân quân",
              members: 5,
            },
            {
              id: 3,
              name: "Cán bộ huấn luyện",
              description: "Tạo và quản lý các kế hoạch, hoạt động huấn luyện",
              members: 3,
            },
            {
              id: 4,
              name: "Thủ kho",
              description: "Quản lý thiết bị, vũ khí, nhập xuất kho",
              members: 2,
            },
            {
              id: 5,
              name: "Văn thư",
              description: "Quản lý tài liệu, văn bản hành chính",
              members: 1,
            },
          ],
          permissions: [
            { name: "Nhân sự" },
            { name: "Hoạt động" },
            { name: "Thiết bị" },
            { name: "Tài liệu" },
            { name: "Huấn luyện" },
            { name: "Báo cáo" },
            { name: "Cài đặt" },
          ],
          editRole(role) {
            this.selectedRole = role;
            this.showModal = true;
          },
        };
      }
    </script>
  </body>
</html>
